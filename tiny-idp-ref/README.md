Replicate the implementation of tiny_idp (:link: https://github.com/asmsuechan/tiny-idp).

Derived from https://www.m3tech.blog/entry/2024/03/05/150000.
