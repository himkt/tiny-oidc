Replicate the implementation of tiny_idp (https://github.com/asmsuechan/tiny-idp) by m3-engineering.

Derived from https://www.m3tech.blog/entry/2024/03/05/150000.
